<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Utility AI Toolkit (Local, No API Keys)</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <!-- SheetJS (XLSX parsing) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <!-- PapaParse (CSV parsing) -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <!-- Chart.js (simple charts) -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #0b0f14;
      --card: #121922;
      --muted: #9cb3c9;
      --text: #e8f1fb;
      --accent: #4bb3fd;
      --accent2: #66e0a3;
      --warn: #ffc857;
      --danger: #ff6b6b;
      --border: #1f2a37;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 800px at 80% -10%, #16212e, var(--bg));
      color: var(--text);
    }
    header {
      padding: 28px 20px;
      display: flex; align-items: center; justify-content: space-between; gap: 12px;
      border-bottom: 1px solid var(--border);
      position: sticky; top: 0; background: rgba(11,15,20,.8); backdrop-filter: blur(8px); z-index: 10;
    }
    .brand { font-weight: 700; letter-spacing: .3px; }
    .wrap { max-width: 1100px; margin: 0 auto; padding: 24px 20px 80px; }
    .tabs { display: flex; gap: 8px; margin: 8px 0 20px; flex-wrap: wrap; }
    .tab-btn {
      background: #0f1720; border: 1px solid var(--border); color: var(--muted);
      padding: 10px 14px; border-radius: 10px; cursor: pointer; transition: .2s;
    }
    .tab-btn.active { color: var(--text); border-color: var(--accent); box-shadow: 0 0 0 2px #4bb3fd30 inset; }
    .card {
      background: linear-gradient(180deg, #121a24, #0e151d);
      border: 1px solid var(--border); border-radius: 14px; padding: 18px; margin-bottom: 16px;
    }
    h1 { margin: 8px 0 12px; font-size: 24px; }
    h2 { margin: 10px 0; font-size: 18px; color: var(--muted); }
    label { display: block; margin: 10px 0 6px; color: var(--muted); }
    input[type="file"], textarea, select {
      width: 100%; background: #0b121a; color: var(--text); border: 1px solid var(--border);
      border-radius: 10px; padding: 10px; resize: vertical;
    }
    textarea { min-height: 160px; }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 14px; }
    .row-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 14px; }
    .btn {
      display: inline-flex; align-items: center; gap: 8px;
      background: linear-gradient(180deg, #1d2a38, #16222f);
      color: var(--text); border: 1px solid var(--border); padding: 10px 14px; border-radius: 10px; cursor: pointer;
    }
    .btn.primary { background: linear-gradient(180deg, #0f65b8, #0a4d8d); border-color: #0a58a5; }
    .btn.ghost { background: transparent; }
    .btn + .btn { margin-left: 8px; }
    .pill { display: inline-block; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--border); color: var(--muted); }
    .muted { color: var(--muted); }
    .grid { display: grid; grid-template-columns: 1fr; gap: 14px; }
    @media (min-width: 980px) { .grid { grid-template-columns: 1.2fr .8fr; } }
    table { width: 100%; border-collapse: collapse; font-size: 14px; }
    th, td { padding: 8px; border-bottom: 1px solid var(--border); text-align: left; }
    canvas { width: 100%; height: 320px; background: #0b121a; border: 1px solid var(--border); border-radius: 10px; padding: 8px; }
    .foot { margin-top: 28px; font-size: 12px; color: var(--muted); text-align: center; }
    .notice { color: var(--warn); }
    .success { color: var(--accent2); }
    .danger { color: var(--danger); }
    .inline { display: inline-flex; gap: 8px; align-items: center; flex-wrap: wrap; }
  </style>
</head>
<body>
  <header>
    <div class="brand">‚öôÔ∏è Utility AI Toolkit ‚Äî Local & Free</div>
    <div class="inline">
      <span class="pill">No logins</span>
      <span class="pill">No API keys</span>
      <span class="pill">All in your browser</span>
    </div>
  </header>

  <div class="wrap">
    <div class="tabs">
      <button class="tab-btn active" data-tab="sheets">üìä Spreadsheet Cleaner & Analyzer</button>
      <button class="tab-btn" data-tab="meetings">üìù Meeting Notes ‚Üí Summary & Actions</button>
      <button class="tab-btn" data-tab="about">‚ÑπÔ∏è About & How to Publish</button>
    </div>

    <!-- SHEETS TAB -->
    <section id="sheets" class="tab card">
      <h1>üìä Spreadsheet Cleaner & Analyzer</h1>
      <p class="muted">Upload a CSV or Excel file. We‚Äôll tidy headers & rows, remove duplicates, compute quick stats, and generate a chart. All locally.</p>

      <div class="grid">
        <div class="card">
          <label for="fileInput">Upload file (.csv, .xlsx)</label>
          <input id="fileInput" type="file" accept=".csv,.xlsx,.xls" />

          <div class="row" style="margin-top:12px">
            <div>
              <label>Delimiter (for CSV only)</label>
              <input type="text" id="csvDelimiter" placeholder="Leave blank to auto-detect" />
            </div>
            <div>
              <label>Duplicate check on columns (comma-separated)</label>
              <input type="text" id="dedupeCols" placeholder="e.g. email, id (optional)" />
            </div>
          </div>

          <div style="margin-top:12px">
            <button class="btn primary" id="processBtn">Process</button>
            <button class="btn" id="downloadCleanBtn" disabled>‚¨áÔ∏è Download Clean CSV</button>
            <button class="btn" id="downloadSummaryBtn" disabled>‚¨áÔ∏è Download Summary</button>
          </div>

          <p id="sheetStatus" class="muted" style="margin-top:10px;"></p>

          <div id="tableWrap" class="card" style="display:none;">
            <h2>Cleaned Preview</h2>
            <div style="max-height:320px; overflow:auto;">
              <table id="previewTable"></table>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>Quick Stats</h2>
          <div class="row">
            <div><span class="muted">Rows:</span> <strong id="statRows">‚Äì</strong></div>
            <div><span class="muted">Columns:</span> <strong id="statCols">‚Äì</strong></div>
          </div>
          <div id="numStats" style="margin-top:10px;"></div>

          <h2 style="margin-top:16px;">Chart a numeric column</h2>
          <select id="numericColumnSelect"><option value="">(none)</option></select>
          <canvas id="chartCanvas" style="margin-top:10px;"></canvas>
        </div>
      </div>
    </section>

    <!-- MEETINGS TAB -->
    <section id="meetings" class="tab card" style="display:none;">
      <h1>üìù Meeting Notes ‚Üí Summary & Action Items</h1>
      <p class="muted">Paste raw notes or a transcript. We‚Äôll create a concise summary and extract action items with owners/dates using local heuristics.</p>
      <div class="row">
        <div class="card">
          <label for="notesInput">Paste notes / transcript</label>
          <textarea id="notesInput" placeholder="Paste your meeting notes here..."></textarea>
          <div class="inline" style="margin-top:8px;">
            <label for="numSentences" style="margin:0;">Summary length</label>
            <select id="numSentences">
              <option value="3">3 sentences</option>
              <option value="5" selected>5 sentences</option>
              <option value="8">8 sentences</option>
            </select>
          </div>
          <div style="margin-top:12px;">
            <button class="btn primary" id="summarizeBtn">Summarize</button>
            <button class="btn" id="downloadMeetingBtn" disabled>‚¨áÔ∏è Download Summary & Actions</button>
          </div>
          <p class="muted" style="margin-top:8px;">Tip: Include speaker names (‚ÄúAlex: ‚Ä¶‚Äù) and dates (‚Äúby Friday‚Äù, ‚Äúon Sept 2‚Äù) for better extraction.</p>
        </div>
        <div class="card">
          <h2>Summary</h2>
          <div id="summaryBox" class="muted">‚Äî</div>
          <h2 style="margin-top:16px;">Action Items</h2>
          <ol id="actionsList"></ol>
        </div>
      </div>
    </section>

    <!-- ABOUT TAB -->
    <section id="about" class="tab card" style="display:none;">
      <h1>‚ÑπÔ∏è About this Project</h1>
      <p>This is a zero‚Äëcost, browser‚Äëonly toolkit. No servers, no API keys, no data leaves your device.</p>
      <h2>How to publish for free on GitHub Pages</h2>
      <ol>
        <li>Create a new public repo on GitHub (e.g., <code>utility-ai-toolkit</code>).</li>
        <li>Add this file as <code>index.html</code>. Commit.</li>
        <li>Go to <em>Settings ‚Üí Pages</em> ‚Üí set Source to <em>Deploy from a branch</em>, pick <em>main</em> and <em>/root</em>. Save.</li>
        <li>Your site appears at <code>https://&lt;your-username&gt;.github.io/utility-ai-toolkit/</code>.</li>
      </ol>
      <p class="notice">Note: External libraries load from public CDNs. If you want 100% offline, download those JS files into your repo and update the <code>&lt;script src&gt;</code> tags to local paths.</p>
      <h2>Roadmap (all still free/local)</h2>
      <ul>
        <li>Add XLSX export (currently CSV).</li>
        <li>Add smarter dedupe (multi-key + fuzzy match).</li>
        <li>Better meeting extraction (lightweight POS tagging; date parsing).</li>
        <li>Optional: Bundle as a PWA for offline cache.</li>
      </ul>
    </section>

    <div class="foot">¬© You ‚Äî build, ship, iterate. No excuses. ‚ú®</div>
  </div>

  <script>
    // --- Tab logic ---
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const tab = btn.dataset.tab;
        document.querySelectorAll('.tab').forEach(s => s.style.display = 'none');
        document.getElementById(tab).style.display = '';
      });
    });

    // -------- Utils --------
    const stopwords = new Set(('a,about,after,again,all,also,an,and,any,are,as,at,be,been,before,being,between,both,but,by,can,do,down,for,from,further,had,has,have,having,he,her,here,hers,him,himself,his,how,i,if,in,into,is,it,its,itself,just,more,most,my,myself,no,nor,not,now,of,off,on,once,only,or,other,our,ours,ourselves,out,over,own,same,she,should,so,some,such,than,that,the,their,theirs,them,themselves,then,there,these,they,this,those,through,to,too,under,until,up,very,was,we,were,what,when,where,which,while,who,whom,why,with,you,your,yours,yourself,yourselves').split(','));
    const cleanText = t => t.toLowerCase().replace(/[^a-z0-9\s:\-\/]/g, ' ');
    const tokenize = t => cleanText(t).split(/\s+/).filter(w => w && !stopwords.has(w));

    function saveText(filename, text) {
      const blob = new Blob([text], {type: 'text/plain;charset=utf-8'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = filename; a.click();
      URL.revokeObjectURL(a.href);
    }

    function saveCSV(filename, rows) {
      const csv = rows.map(r => r.map(v => {
        const s = (v ?? '').toString();
        return /[",\n]/.test(s) ? '"' + s.replace(/"/g,'""') + '"' : s;
      }).join(',')).join('\n');
      const blob = new Blob([csv], {type:'text/csv;charset=utf-8'});
      const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
      a.download = filename; a.click(); URL.revokeObjectURL(a.href);
    }

    // -------- SHEETS: parse / clean / stats --------
    let cleanedRows = [], cleanedHeaders = [], numericColumns = [], numericIdx = [];
    let chart, tableBuilt = false;

    function parseCSV(file, delimiter) {
      return new Promise((resolve, reject) => {
        Papa.parse(file, {
          header: true, skipEmptyLines: true, delimiter: delimiter || undefined,
          complete: res => resolve(res.data), error: err => reject(err)
        });
      });
    }

    function parseXLSX(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.onload = e => {
          const data = new Uint8Array(e.target.result);
          const workbook = XLSX.read(data, {type: 'array'});
          const firstSheet = workbook.SheetNames[0];
          const sheet = workbook.Sheets[firstSheet];
          const arr = XLSX.utils.sheet_to_json(sheet, {defval: ''}); // array of objects
          resolve(arr);
        };
        reader.onerror = reject;
        reader.readAsArrayBuffer(file);
      });
    }

    function standardizeHeaders(headers) {
      return headers.map(h => h.trim().toLowerCase().replace(/\s+/g,'_').replace(/[^\w]/g,''));
    }

    function removeEmptyRows(rows) {
      return rows.filter(r => Object.values(r).some(v => (v ?? '').toString().trim() !== ''));
    }

    function dedupeRows(rows, keys) {
      if (!keys.length) return rows;
      const seen = new Set();
      const out = [];
      for (const r of rows) {
        const sig = keys.map(k => (r[k] ?? '').toString().trim().toLowerCase()).join('||');
        if (sig && !seen.has(sig)) { seen.add(sig); out.push(r); }
      }
      return out;
    }

    function objectRowsToMatrix(rows) {
      const headers = Object.keys(rows[0] || {});
      const headerStd = standardizeHeaders(headers);
      const matrix = [headerStd];
      for (const r of rows) {
        matrix.push(headerStd.map((h, i) => {
          const originalKey = headers[i];
          let v = r[originalKey];
          if (typeof v === 'string') v = v.trim();
          return v;
        }));
      }
      return matrix;
    }

    function computeStats(matrix) {
      // matrix[0] = headers
      const headers = matrix[0];
      const cols = headers.length;
      const rows = matrix.slice(1);
      document.getElementById('statRows').textContent = rows.length.toString();
      document.getElementById('statCols').textContent = cols.toString();

      // Detect numeric columns
      numericColumns = [];
      numericIdx = [];
      for (let j=0; j<cols; j++) {
        const colVals = rows.map(r => r[j]).filter(v => v !== null && v !== undefined && v !== '');
        const numericVals = colVals.map(v => +v).filter(v => !isNaN(v));
        const ratio = (numericVals.length) / Math.max(1, colVals.length);
        if (numericVals.length && ratio > 0.8) {
          numericColumns.push(headers[j]);
          numericIdx.push(j);
        }
      }

      // Fill select
      const sel = document.getElementById('numericColumnSelect');
      sel.innerHTML = '<option value="">(none)</option>';
      numericColumns.forEach((name, i) => {
        const opt = document.createElement('option'); opt.value = String(i); opt.textContent = name; sel.appendChild(opt);
      });

      // Show per-numeric basic stats
      const container = document.getElementById('numStats');
      container.innerHTML = '';
      numericIdx.forEach((j, idx) => {
        const vals = rows.map(r => +r[j]).filter(v => !isNaN(v));
        const min = Math.min(...vals);
        const max = Math.max(...vals);
        const mean = (vals.reduce((a,b)=>a+b,0)/vals.length).toFixed(2);
        const unique = new Set(vals.map(v => v.toString())).size;
        const div = document.createElement('div');
        div.style.marginTop = '8px';
        div.innerHTML = `<div><strong>${numericColumns[idx]}</strong></div>
          <div class="muted">min ${min} ‚Ä¢ max ${max} ‚Ä¢ mean ${mean} ‚Ä¢ unique ${unique}</div>`;
        container.appendChild(div);
      });
    }

    function buildPreviewTable(matrix, limit=200) {
      const table = document.getElementById('previewTable');
      table.innerHTML = '';
      const thead = document.createElement('thead');
      const trh = document.createElement('tr');
      matrix[0].forEach(h => { const th = document.createElement('th'); th.textContent = h; trh.appendChild(th); });
      thead.appendChild(trh);
      const tbody = document.createElement('tbody');
      matrix.slice(1, 1+limit).forEach(row => {
        const tr = document.createElement('tr');
        row.forEach(v => { const td = document.createElement('td'); td.textContent = v; tr.appendChild(td); });
        tbody.appendChild(tr);
      });
      table.appendChild(thead); table.appendChild(tbody);
      document.getElementById('tableWrap').style.display = '';
      tableBuilt = true;
    }

    async function handleProcess() {
      const f = document.getElementById('fileInput').files[0];
      const status = document.getElementById('sheetStatus');
      if (!f) { status.textContent = 'Please choose a CSV/XLSX file.'; return; }
      status.textContent = 'Processing‚Ä¶';

      let rowsObj = [];
      try {
        if (/\.(xlsx|xls)$/i.test(f.name)) rowsObj = await parseXLSX(f);
        else rowsObj = await parseCSV(f, document.getElementById('csvDelimiter').value.trim());
      } catch (e) {
        status.innerHTML = `<span class="danger">Failed to parse file: ${e.message}</span>`; return;
      }

      // Remove empty rows
      rowsObj = removeEmptyRows(rowsObj);

      // Re-map to standardized headers & trimmed cell values
      const matrix0 = objectRowsToMatrix(rowsObj);
      const headers = matrix0[0]; // standardized
      const body = matrix0.slice(1).map(r => r.map(v => (typeof v === 'string' ? v.trim() : v)));

      // De-duplicate
      let dedupeKeys = document.getElementById('dedupeCols').value.trim();
      let keyIdx = [];
      if (dedupeKeys) {
        const keys = dedupeKeys.split(',').map(s => s.trim().toLowerCase().replace(/\s+/g,'_'));
        keyIdx = keys.map(k => headers.indexOf(k)).filter(i => i >= 0);
      }
      const seen = new Set(); const deduped = [];
      for (const row of body) {
        const sig = keyIdx.length ? keyIdx.map(i => (row[i] ?? '').toString().toLowerCase()).join('||')
                                  : row.join('||').toLowerCase();
        if (sig && !seen.has(sig)) { seen.add(sig); deduped.push(row); }
      }

      cleanedHeaders = headers;
      cleanedRows = deduped;

      // Update UI
      buildPreviewTable([headers, ...deduped]);
      computeStats([headers, ...deduped]);
      status.innerHTML = `<span class="success">Done. Rows: ${deduped.length}, Columns: ${headers.length}</span>`;
      document.getElementById('downloadCleanBtn').disabled = false;
      document.getElementById('downloadSummaryBtn').disabled = false;
    }

    document.getElementById('processBtn').addEventListener('click', handleProcess);

    document.getElementById('downloadCleanBtn').addEventListener('click', () => {
      if (!cleanedRows.length) return;
      const rows = [cleanedHeaders, ...cleanedRows];
      saveCSV('cleaned.csv', rows);
    });

    document.getElementById('numericColumnSelect').addEventListener('change', (e) => {
      const idxInNumeric = +e.target.value;
      const canvas = document.getElementById('chartCanvas').getContext('2d');
      if (isNaN(idxInNumeric)) { if (chart) chart.destroy(); return; }
      const j = numericIdx[idxInNumeric];
      const label = numericColumns[idxInNumeric];
      const labels = cleanedRows.map((_, i) => String(i+1));
      const values = cleanedRows.map(r => +r[j]).filter(v => !isNaN(v));
      if (chart) chart.destroy();
      chart = new Chart(canvas, {
        type: 'bar',
        data: { labels, datasets: [{ label: label, data: values }] },
        options: { responsive: true, scales: { x: { ticks: { display: false } } } }
      });
    });

    document.getElementById('downloadSummaryBtn').addEventListener('click', () => {
      if (!cleanedRows.length) return;
      // Build a quick textual summary of numeric columns
      let out = [];
      out.push('Spreadsheet Summary');
      out.push('===================');
      out.push(`Rows: ${cleanedRows.length}`);
      out.push(`Columns: ${cleanedHeaders.length}`);
      if (numericIdx.length) {
        out.push('');
        out.push('Numeric Columns:');
        cleanedRows.length && numericIdx.forEach((j, k) => {
          const vals = cleanedRows.map(r => +r[j]).filter(v => !isNaN(v));
          if (!vals.length) return;
          const min = Math.min(...vals);
          const max = Math.max(...vals);
          const mean = (vals.reduce((a,b)=>a+b,0)/vals.length).toFixed(2);
          out.push(`- ${numericColumns[k]} ‚Üí min ${min}, max ${max}, mean ${mean}`);
        });
      }
      saveText('summary.txt', out.join('\n'));
    });

    // -------- MEETINGS: summarize & extract actions (local heuristics) --------
    function splitSentences(text) {
      // naive sentence split; good enough for transcripts
      return text
        .replace(/\n+/g, ' ')
        .split(/(?<=[\.\!\?])\s+/)
        .map(s => s.trim())
        .filter(Boolean);
    }

    function sentenceScore(sent, tf) {
      const words = tokenize(sent);
      return words.reduce((sum,w) => sum + (tf[w] || 0), 0) / Math.sqrt(words.length + 1);
    }

    function summarize(text, n=5) {
      const sentences = splitSentences(text);
      if (sentences.length <= n) return sentences;
      const tf = {};
      sentences.forEach(s => tokenize(s).forEach(w => tf[w] = (tf[w]||0)+1));
      // normalize
      const maxf = Math.max(...Object.values(tf));
      Object.keys(tf).forEach(w => tf[w] = tf[w]/maxf);

      const scored = sentences.map((s,i) => ({ i, s, score: sentenceScore(s, tf) }));
      scored.sort((a,b) => b.score - a.score);
      const top = scored.slice(0, n).sort((a,b) => a.i - b.i).map(x => x.s);
      return top;
    }

    function extractActions(text) {
      const lines = text.split(/\n+/).map(l => l.trim()).filter(Boolean);
      const actions = [];

      // Simple owner/date patterns
      const ownerPat = /\b([A-Z][a-z]+(?:\s[A-Z][a-z]+)?)\b(?=[:\- ]| will| to)\s*/; // e.g., "Alex -", "Alex will"
      const datePat = /\b(by|on|before|due)\s+([A-Za-z]{3,9}\s?\d{1,2}|\d{1,2}\/\d{1,2}(?:\/\d{2,4})?|tomorrow|today|next\s+\w+|EOW|EOD)\b/i;

      // Imperative starters or explicit task cues
      const imperativePat = /^(please\s+)?(send|create|prepare|review|follow|update|email|schedule|draft|share|compile|confirm|investigate|fix|ship|launch|test|call|meet|analyze|document)\b/i;
      const cuePat = /\b(action|todo|task|follow[-\s]?up|next steps?)\b/i;

      lines.forEach(l => {
        let isAction = imperativePat.test(l) || cuePat.test(l);
        let owner = null, due = null;

        const ownerMatch = l.match(ownerPat);
        if (ownerMatch) owner = ownerMatch[1];

        const dateMatch = l.match(datePat);
        if (dateMatch) due = dateMatch[0];

        // Also scan sentence-level if lines are long paragraphs
        if (!isAction) {
          const sents = splitSentences(l);
          for (const s of sents) {
            if (imperativePat.test(s) || cuePat.test(s)) { isAction = true; if (!owner) {
              const om = s.match(ownerPat); if (om) owner = om[1];
            }
            if (!due) { const dm = s.match(datePat); if (dm) due = dm[0]; }
            break; }
          }
        }

        if (isAction) {
          actions.push({ text: l.replace(/^\-+\s*/,'').trim(), owner: owner || 'Unassigned', due: due || '‚Äî' });
        }
      });

      // Deduplicate similar lines
      const seen = new Set();
      return actions.filter(a => {
        const sig = a.text.toLowerCase();
        if (seen.has(sig)) return false; seen.add(sig); return true;
      });
    }

    document.getElementById('summarizeBtn').addEventListener('click', () => {
      const raw = document.getElementById('notesInput').value.trim();
      const n = +document.getElementById('numSentences').value;
      if (!raw) return;
      const sum = summarize(raw, n);
      const acts = extractActions(raw);

      const summaryBox = document.getElementById('summaryBox');
      summaryBox.textContent = sum.join(' ');

      const list = document.getElementById('actionsList');
      list.innerHTML = '';
      acts.forEach(a => {
        const li = document.createElement('li');
        li.innerHTML = `<div>${a.text}</div><div class="muted">Owner: <strong>${a.owner}</strong> ‚Ä¢ Due: <strong>${a.due}</strong></div>`;
        list.appendChild(li);
      });

      document.getElementById('downloadMeetingBtn').disabled = false;
    });

    document.getElementById('downloadMeetingBtn').addEventListener('click', () => {
      const sum = document.getElementById('summaryBox').textContent || '';
      const lis = [...document.querySelectorAll('#actionsList li')].map(li => li.textContent.trim());
      const out = [
        'Meeting Summary',
        '==============',
        sum, '',
        'Action Items',
        '============',
        ...lis.map((t, i) => `${i+1}. ${t}`)
      ].join('\n');
      saveText('meeting_summary.txt', out);
    });
  </script>
</body>
</html>
