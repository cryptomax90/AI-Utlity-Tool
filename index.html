<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Utility AI ‚Äî Clean Sheets & Meeting Summaries</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Core libs -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx-populate/browser/xlsx-populate.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mammoth/mammoth.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.4.168/build/pdf.min.js"></script>
  <script>if (window['pdfjsLib']) { pdfjsLib.GlobalWorkerOptions.workerSrc='https://cdn.jsdelivr.net/npm/pdfjs-dist@4.4.168/build/pdf.worker.min.js'; }</script>
  <script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.js"></script>
</head>
<body>
  <header class="navbar">
    <div class="left">
      <div class="logo-dot"></div>
      <div class="brand">Utility <strong>AI</strong></div>
    </div>
    <nav class="right">
      <a class="navlink active" data-tab="sheets">Spreadsheets</a>
      <a class="navlink" data-tab="meetings">Meeting Notes</a>
      <a class="navlink" data-tab="branding">Branding</a>
      <a class="navlink" data-tab="settings">AI Settings</a>
    </nav>
  </header>

  <main class="container">
    <!-- Sheets -->
    <section id="sheets" class="panel active">
      <div class="panel-head">
        <h1>üìä Spreadsheet ‚Üí Clean & Present</h1>
        <p class="muted">Upload raw CSV/XLSX. AI cleans data and returns a formatted table, insights, and a branded Excel export.</p>
      </div>
      <div class="grid two">
        <div class="card">
          <label>Upload (.csv, .xlsx)</label>
          <input id="sheetFile" type="file" accept=".csv,.xlsx,.xls" />
          <div class="inline gap">
            <button id="runSheetAI" class="btn primary">Run AI Clean + Insights</button>
            <button id="downloadCleanCSV" class="btn" disabled>Download Clean CSV</button>
            <button id="downloadCleanXLSX" class="btn" disabled>Download Clean XLSX</button>
            <button id="downloadBrandedXLSX" class="btn" disabled>üé® Branded Excel</button>
          </div>
          <div id="sheetStatus" class="status"></div>
          <div id="sheetPreview" class="tablewrap" style="display:none;">
            <table id="sheetTable"></table>
          </div>
        </div>

        <div class="card">
          <h2 class="section">Executive Insights</h2>
          <div id="sheetInsights" class="prose bullets">‚Äî</div>
          <h2 class="section">Recommendations</h2>
          <ol id="sheetRecs" class="prose"> </ol>
        </div>
      </div>
    </section>

    <!-- Meetings -->
    <section id="meetings" class="panel">
      <div class="panel-head">
        <h1>üìù Meeting Notes ‚Üí Branded Summary</h1>
        <p class="muted">Paste notes and attach PDF/DOCX/TXT. AI returns a crisp executive summary and action items with owners & due dates.</p>
      </div>
      <div class="grid two">
        <div class="card">
          <label>Paste notes</label>
          <textarea id="notesText" placeholder="Paste meeting notes here‚Ä¶"></textarea>
          <label>Attach files (PDF, DOCX, TXT)</label>
          <input id="notesFiles" type="file" multiple accept=".pdf,.docx,.txt" />
          <div class="inline gap">
            <button id="runNotesAI" class="btn primary">Run AI Summary</button>
            <button id="downloadPDF" class="btn" disabled>‚¨áÔ∏è Branded PDF</button>
            <button id="downloadDOCX" class="btn" disabled>‚¨áÔ∏è Branded DOCX</button>
          </div>
          <div id="attachStatus" class="status"></div>
        </div>

        <div class="card">
          <h2 class="section">Executive Summary</h2>
          <div id="sumBox" class="prose bullets">‚Äî</div>
          <h2 class="section">Action Items</h2>
          <ol id="actionsList" class="prose numbered"></ol>
        </div>
      </div>
    </section>

    <!-- Branding -->
    <section id="branding" class="panel">
      <div class="panel-head">
        <h1>üé® Branding</h1>
        <p class="muted">Your exports use these styles. Text defaults to black for readability.</p>
      </div>
      <div class="grid two">
        <div class="card">
          <label>Company Name</label>
          <input id="brandName" type="text" placeholder="Acme Corp" />
          <label>Primary Color</label>
          <input id="brandPrimary" type="color" value="#0f65b8" />
          <label>Secondary Color</label>
          <input id="brandSecondary" type="color" value="#66e0a3" />
          <label>Logo (PNG/JPG)</label>
          <input id="brandLogo" type="file" accept="image/png,image/jpeg" />
          <div class="inline gap">
            <button id="saveBrand" class="btn primary">Save</button>
            <button id="resetBrand" class="btn">Reset</button>
          </div>
          <div id="brandMsg" class="status"></div>
        </div>
        <div class="card">
          <h2 class="section">Preview</h2>
          <div class="brandPreview">
            <div id="prevLogo" class="prevLogo">LOGO</div>
            <div>
              <div id="prevName" class="prevName">Company</div>
              <div class="swatches">
                <div id="sw1" class="swatch"></div>
                <div id="sw2" class="swatch"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Settings -->
    <section id="settings" class="panel">
      <div class="panel-head">
        <h1>üîê AI Settings</h1>
        <p class="muted">All features use AI via your secure proxy.</p>
      </div>
      <div class="card">
        <label>Proxy URL</label>
        <input id="proxyUrl" type="text" placeholder="https://your-worker.workers.dev/" />
        <label>Access Token (if required)</label>
        <input id="proxyToken" type="text" placeholder="ACCESS_TOKEN" />
        <label>Model</label>
        <select id="model">
          <option value="gpt-4o-mini">gpt-4o-mini</option>
          <option value="gpt-4o">gpt-4o</option>
        </select>
        <div class="inline gap">
          <button id="saveAI" class="btn primary">Save</button>
          <button id="testAI" class="btn">Test Connection</button>
        </div>
        <div id="aiMsg" class="status"></div>
      </div>
    </section>
  </main>

  <footer class="foot">¬© You ‚Äî ship boldly.</footer>
  <script src="app.js"></script>
</body>
</html>
