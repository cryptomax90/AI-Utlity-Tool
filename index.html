<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Utility AI Toolkit (Local, No API Keys)</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  <!-- External libs (free) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chrono-node@2.7.5/dist/chrono.min.js"></script>
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#0b0f14">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <div class="brand">âš™ï¸ Utility AI Toolkit â€” Local & Free</div>
    <div class="inline">
      <span class="pill">No logins</span>
      <span class="pill">No API keys</span>
      <span class="pill">All in your browser</span>
      <span class="pill">Works offline (PWA)</span>
    </div>
  </header>

  <div class="wrap">
    <div class="tabs">
      <button class="tab-btn active" data-tab="sheets">ğŸ“Š Spreadsheet Cleaner & Analyzer</button>
      <button class="tab-btn" data-tab="meetings">ğŸ“ Meeting Notes â†’ Summary & Actions</button>
      <button class="tab-btn" data-tab="about">â„¹ï¸ About & How to Publish</button>
    </div>

    <!-- SHEETS TAB -->
    <section id="sheets" class="tab card">
      <h1>ğŸ“Š Spreadsheet Cleaner & Analyzer</h1>
      <p class="muted">Upload a CSV or Excel file. Weâ€™ll tidy headers & rows, remove duplicates (exact or fuzzy), compute quick stats, and generate a chart. All locally.</p>

      <div class="grid">
        <div class="card">
          <label for="fileInput">Upload file (.csv, .xlsx)</label>
          <input id="fileInput" type="file" accept=".csv,.xlsx,.xls" />

          <div class="row" style="margin-top:12px">
            <div>
              <label>Delimiter (for CSV only)</label>
              <input type="text" id="csvDelimiter" placeholder="Leave blank to auto-detect" />
            </div>
            <div>
              <label>Duplicate check on columns (comma-separated)</label>
              <input type="text" id="dedupeCols" placeholder="e.g. email, id (optional)" />
            </div>
          </div>

          <div class="row" style="margin-top:12px">
            <div>
              <label><input type="checkbox" id="fuzzyToggle" /> Fuzzy de-dupe</label>
              <small class="muted">Matches near-identical values (Jaroâ€“Winkler)</small>
            </div>
            <div>
              <label>Fuzzy threshold (0.85â€“0.98)</label>
              <input type="number" id="fuzzyThreshold" min="0.80" max="0.99" step="0.01" value="0.92" />
            </div>
          </div>

          <div style="margin-top:12px">
            <button class="btn primary" id="processBtn">Process</button>
            <button class="btn" id="downloadCleanBtn" disabled>â¬‡ï¸ Download Clean CSV</button>
            <button class="btn" id="downloadXLSXBtn" disabled>â¬‡ï¸ Download Excel (.xlsx)</button>
            <button class="btn" id="downloadSummaryBtn" disabled>â¬‡ï¸ Download Summary</button>
          </div>

          <p id="sheetStatus" class="muted" style="margin-top:10px;"></p>

          <div id="tableWrap" class="card" style="display:none;">
            <h2>Cleaned Preview</h2>
            <div style="max-height:320px; overflow:auto;">
              <table id="previewTable"></table>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>Quick Stats</h2>
          <div class="row">
            <div><span class="muted">Rows:</span> <strong id="statRows">â€“</strong></div>
            <div><span class="muted">Columns:</span> <strong id="statCols">â€“</strong></div>
          </div>
          <div id="numStats" style="margin-top:10px;"></div>

          <h2 style="margin-top:16px;">Chart a numeric column</h2>
          <select id="numericColumnSelect"><option value="">(none)</option></select>
          <canvas id="chartCanvas" style="margin-top:10px;"></canvas>
        </div>
      </div>
    </section>

    <!-- MEETINGS TAB -->
    <section id="meetings" class="tab card" style="display:none;">
      <h1>ğŸ“ Meeting Notes â†’ Summary & Action Items</h1>
      <p class="muted">Paste raw notes or a transcript. Weâ€™ll create a concise summary and extract action items with owners/dates (parsed to ISO if possible).</p>
      <div class="row">
        <div class="card">
          <label for="notesInput">Paste notes / transcript</label>
          <textarea id="notesInput" placeholder="Paste your meeting notes here..."></textarea>
          <div class="inline" style="margin-top:8px;">
            <label for="numSentences" style="margin:0;">Summary length</label>
            <select id="numSentences">
              <option value="3">3 sentences</option>
              <option value="5" selected>5 sentences</option>
              <option value="8">8 sentences</option>
            </select>
          </div>
          <div style="margin-top:12px;">
            <button class="btn primary" id="summarizeBtn">Summarize</button>
            <button class="btn" id="downloadMeetingBtn" disabled>â¬‡ï¸ Download Summary & Actions</button>
          </div>
          <p class="muted" style="margin-top:8px;">Tip: Include speaker names (â€œAlex: â€¦â€) and dates (â€œby Fridayâ€, â€œon Sept 2â€) for better extraction.</p>
        </div>
        <div class="card">
          <h2>Summary</h2>
          <div id="summaryBox" class="muted">â€”</div>
          <h2 style="margin-top:16px;">Action Items</h2>
          <ol id="actionsList"></ol>
        </div>
      </div>
    </section>

    <!-- ABOUT TAB -->
    <section id="about" class="tab card" style="display:none;">
      <h1>â„¹ï¸ About this Project</h1>
      <p>This is a zero-cost, browser-only toolkit. No servers, no API keys, no data leaves your device.</p>
      <h2>How to publish for free on GitHub Pages</h2>
      <ol>
        <li>Create a new public repo on GitHub (e.g., <code>utility-ai-toolkit</code>).</li>
        <li>Add these files. Make sure <code>index.html</code> is at the root.</li>
        <li>Go to <em>Settings â†’ Pages</em> â†’ set Source to <em>Deploy from a branch</em>, pick <em>main</em> and <em>/root</em>. Save.</li>
        <li>Your site appears at <code>https://&lt;your-username&gt;.github.io/&lt;repo&gt;/</code>.</li>
      </ol>
      <p class="notice">Note: External libraries load from public CDNs. For 100% offline, download those JS files into this repo and update the <code>&lt;script src&gt;</code> tags.</p>
      <h2>Roadmap</h2>
      <ul>
        <li>Self-host vendor JS for full offline use.</li>
        <li>Advanced charts and pivoting.</li>
        <li>Optional on-device ML summarizer via Transformers.js.</li>
      </ul>
    </section>

    <div class="foot">Â© You â€” build, ship, iterate. âœ¨</div>
  </div>

  <script src="app.js"></script>
</body>
</html>

